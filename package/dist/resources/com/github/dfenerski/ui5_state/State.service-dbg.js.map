{"version":3,"file":"State.service-dbg.js","names":["E_MODEL_EXISTS","___misc_errors","ModelFactory","___model_factory_Modelfactory","StateService","constructor","_ref","registrationToken","componentRef","skipRegistration","existingModelRef","rest","_model","createModel","_registrationToken","_component","register","_data","getData","state","component","getModel","setModel","set","data","setData","__exports","__esModule"],"sources":["State.service.ts"],"sourcesContent":["import type Component from 'sap/ui/core/Component';\nimport JSONModel from 'sap/ui/model/json/JSONModel';\nimport type { ICreateNamedModel } from './interfaces/ICreateNamedModel';\nimport { E_MODEL_EXISTS } from './misc/errors';\nimport { ModelFactory } from './model-factory/Model.factory';\nimport type { DeepPartial } from './types/DeepPartial';\nimport type { DeepReadonly } from './types/DeepReadonly';\n\nexport abstract class StateService<T extends {}> {\n    /**\n     * The registrationToken of the model. Must be unique, otherwise registration to the component in the constructor will fail.\n     */\n    private readonly _registrationToken: string;\n\n    /**\n     * The component reference.\n     */\n    protected readonly _component: Component;\n\n    /**\n     * The native model instance.\n     */\n    protected readonly _model: JSONModel;\n\n    constructor({\n        registrationToken,\n        componentRef,\n        skipRegistration,\n        existingModelRef,\n        ...rest\n    }: ICreateNamedModel<T>) {\n        // Create model trough factory method, save reference\n        this._model = existingModelRef || ModelFactory.createModel(rest);\n        // Save registration token reference\n        this._registrationToken = registrationToken;\n        //\n        this._component = componentRef;\n        skipRegistration || this.register();\n    }\n\n    /**\n     * Generic getter for the model's data. Proxied call to the native model's getData method.\n     */\n    protected get _data(): T {\n        return <T>this._model.getData();\n    }\n\n    /**\n     * Generic getter for the model's data. Returns immutable ref to the data; setters should be used for modifications.\n     */\n    public get state(): DeepReadonly<T> {\n        return <DeepReadonly<T>>this._data;\n    }\n\n    /**\n     * Getter for the state service's registration token.\n     */\n    public get registrationToken(): string {\n        return this._registrationToken;\n    }\n\n    public register() {\n        const component = this._component;\n        const registrationToken = this.registrationToken;\n        // Abort if model is already registered.\n        if (component.getModel(registrationToken)) {\n            throw E_MODEL_EXISTS;\n        }\n        // Register model to the component.\n        component.setModel(this._model, registrationToken);\n    }\n\n    /**\n     * Generic setter for the model's data. Merges the provided data with the existing data natively.\n     */\n    protected set(data: DeepPartial<T>): void {\n        this._model.setData(data, true);\n    }\n}\n"],"mappings":";;;;;QAGSA,cAAc,GAAAC,cAAA;EAAA,MACdC,YAAY,GAAAC,6BAAA;EAId,MAAeC,YAAY,CAAe;IAC7C;AACJ;AACA;;IAGI;AACJ;AACA;;IAGI;AACJ;AACA;;IAGIC,WAAWA,CAAAC,IAAA,EAMc;MAAA,IANb;QACRC,iBAAiB;QACjBC,YAAY;QACZC,gBAAgB;QAChBC,gBAAgB;QAChB,GAAGC;MACe,CAAC,GAAAL,IAAA;MACnB;MACA,IAAI,CAACM,MAAM,GAAGF,gBAAgB,IAAIR,YAAY,CAACW,WAAW,CAACF,IAAI,CAAC;MAChE;MACA,IAAI,CAACG,kBAAkB,GAAGP,iBAAiB;MAC3C;MACA,IAAI,CAACQ,UAAU,GAAGP,YAAY;MAC9BC,gBAAgB,IAAI,IAAI,CAACO,QAAQ,CAAC,CAAC;IACvC;;IAEA;AACJ;AACA;IACI,IAAcC,KAAKA,CAAA,EAAM;MACrB,OAAU,IAAI,CAACL,MAAM,CAACM,OAAO,CAAC,CAAC;IACnC;;IAEA;AACJ;AACA;IACI,IAAWC,KAAKA,CAAA,EAAoB;MAChC,OAAwB,IAAI,CAACF,KAAK;IACtC;;IAEA;AACJ;AACA;IACI,IAAWV,iBAAiBA,CAAA,EAAW;MACnC,OAAO,IAAI,CAACO,kBAAkB;IAClC;IAEOE,QAAQA,CAAA,EAAG;MACd,MAAMI,SAAS,GAAG,IAAI,CAACL,UAAU;MACjC,MAAMR,iBAAiB,GAAG,IAAI,CAACA,iBAAiB;MAChD;MACA,IAAIa,SAAS,CAACC,QAAQ,CAACd,iBAAiB,CAAC,EAAE;QACvC,MAAMP,cAAc;MACxB;MACA;MACAoB,SAAS,CAACE,QAAQ,CAAC,IAAI,CAACV,MAAM,EAAEL,iBAAiB,CAAC;IACtD;;IAEA;AACJ;AACA;IACcgB,GAAGA,CAACC,IAAoB,EAAQ;MACtC,IAAI,CAACZ,MAAM,CAACa,OAAO,CAACD,IAAI,EAAE,IAAI,CAAC;IACnC;EACJ;EAAC,IAAAE,SAAA;IAAAC,UAAA;EAAA;EAAAD,SAAA,CAAAtB,YAAA,GAAAA,YAAA;EAAA,OAAAsB,SAAA;AAAA","ignoreList":[]}