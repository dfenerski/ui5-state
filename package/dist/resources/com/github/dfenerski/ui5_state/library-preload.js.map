{"version":3,"file":"library-preload.js","sections":[{"offset":{"line":1,"column":0},"map":{"version":3,"names":[],"sources":["library-preload.js?bundle-code-0"],"mappings":"AAAA;AACA","sourcesContent":["sap.ui.require.preload({\n"],"sourceRoot":""}},{"offset":{"line":3,"column":0},"map":{"version":3,"file":"State.service.js","names":["E_MODEL_EXISTS","___misc_errors","ModelFactory","___model_factory_Modelfactory","StateService","constructor","_ref","registrationToken","componentRef","skipRegistration","existingModelRef","rest","this","_model","createModel","_registrationToken","_component","register","_data","getData","state","component","getModel","setModel","set","data","setData","__exports","__esModule"],"sources":["State.service.ts"],"sourcesContent":["import type Component from 'sap/ui/core/Component';\nimport JSONModel from 'sap/ui/model/json/JSONModel';\nimport type { ICreateNamedModel } from './interfaces/ICreateNamedModel';\nimport { E_MODEL_EXISTS } from './misc/errors';\nimport { ModelFactory } from './model-factory/Model.factory';\nimport type { DeepPartial } from './types/DeepPartial';\nimport type { DeepReadonly } from './types/DeepReadonly';\n\nexport abstract class StateService<T extends {}> {\n    /**\n     * The registrationToken of the model. Must be unique, otherwise registration to the component in the constructor will fail.\n     */\n    private readonly _registrationToken: string;\n\n    /**\n     * The component reference.\n     */\n    protected readonly _component: Component;\n\n    /**\n     * The native model instance.\n     */\n    protected readonly _model: JSONModel;\n\n    constructor({\n        registrationToken,\n        componentRef,\n        skipRegistration,\n        existingModelRef,\n        ...rest\n    }: ICreateNamedModel<T>) {\n        // Create model trough factory method, save reference\n        this._model = existingModelRef || ModelFactory.createModel(rest);\n        // Save registration token reference\n        this._registrationToken = registrationToken;\n        //\n        this._component = componentRef;\n        skipRegistration || this.register();\n    }\n\n    /**\n     * Generic getter for the model's data. Proxied call to the native model's getData method.\n     */\n    protected get _data(): T {\n        return <T>this._model.getData();\n    }\n\n    /**\n     * Generic getter for the model's data. Returns immutable ref to the data; setters should be used for modifications.\n     */\n    public get state(): DeepReadonly<T> {\n        return <DeepReadonly<T>>this._data;\n    }\n\n    /**\n     * Getter for the state service's registration token.\n     */\n    public get registrationToken(): string {\n        return this._registrationToken;\n    }\n\n    public register() {\n        const component = this._component;\n        const registrationToken = this.registrationToken;\n        // Abort if model is already registered.\n        if (component.getModel(registrationToken)) {\n            throw E_MODEL_EXISTS;\n        }\n        // Register model to the component.\n        component.setModel(this._model, registrationToken);\n    }\n\n    /**\n     * Generic setter for the model's data. Merges the provided data with the existing data natively.\n     */\n    protected set(data: DeepPartial<T>): void {\n        this._model.setData(data, true);\n    }\n}\n"],"mappings":"AAAA,8GAGSA,EAAcC,EAAA,wBACdC,EAAYC,EAAA,gBAId,MAAeC,EAgBlBC,YAAWC,GAMc,IANbC,kBACRA,EAAiBC,aACjBA,EAAYC,iBACZA,EAAgBC,iBAChBA,KACGC,GACgBL,EAEnBM,KAAKC,OAASH,GAAoBR,EAAaY,YAAYH,GAE3DC,KAAKG,mBAAqBR,EAE1BK,KAAKI,WAAaR,EAClBC,GAAoBG,KAAKK,UAC7B,CAKA,SAAcC,GACV,OAAUN,KAAKC,OAAOM,SAC1B,CAKA,SAAWC,GACP,OAAwBR,KAAKM,KACjC,CAKA,qBAAWX,GACP,OAAOK,KAAKG,kBAChB,CAEOE,WACH,MAAMI,EAAYT,KAAKI,WACvB,MAAMT,EAAoBK,KAAKL,kBAE/B,GAAIc,EAAUC,SAASf,GAAoB,CACvC,MAAMP,CACV,CAEAqB,EAAUE,SAASX,KAAKC,OAAQN,EACpC,CAKUiB,IAAIC,GACVb,KAAKC,OAAOa,QAAQD,EAAM,KAC9B,EACH,IAAAE,EAAA,CAAAC,WAAA,MAAAD,EAAAvB,eAAA,OAAAuB,CAAA","ignoreList":[],"sourceRoot":""}},{"offset":{"line":6,"column":0},"map":{"version":3,"file":"ICreateNamedModel.js","names":[],"sources":[],"mappings":"AAAA,","ignoreList":[],"sourceRoot":"interfaces"}},{"offset":{"line":9,"column":0},"map":{"version":3,"file":"library.js","names":["sap","ui","loader","config","map","thisLib","Lib","init","name","version","dependencies","types","interfaces","controls","elements","noLibraryCSS"],"sources":["library.ts"],"sourcesContent":["import Lib from 'sap/ui/core/Lib';\n\nsap.ui.loader.config({\n    map: {\n        '*': {\n            'ui5-state': 'com/github/dfenerski/ui5_state',\n        },\n    },\n});\n\n// Delegate further initialization of this library to the Core\nconst thisLib: { [key: string]: unknown } = Lib.init({\n    name: 'com.github.dfenerski.ui5_state',\n    version: '${version}',\n    dependencies: [],\n    types: [],\n    interfaces: [],\n    controls: [],\n    elements: [],\n    noLibraryCSS: true,\n}) as { [key: string]: unknown };\n\n// Export the library namespace\nexport default thisLib;\n"],"mappings":"AAAA,wEAEAA,IAAIC,GAAGC,OAAOC,OAAO,CACjBC,IAAK,CACD,IAAK,CACD,YAAa,qCAMzB,MAAMC,EAAsCC,EAAIC,KAAK,CACjDC,KAAM,iCACNC,QAAS,aACTC,aAAc,GACdC,MAAO,GACPC,WAAY,GACZC,SAAU,GACVC,SAAU,GACVC,aAAc,OAGlB,OACeV,CAAO","ignoreList":[],"sourceRoot":""}},{"offset":{"line":13,"column":0},"map":{"version":3,"file":"errors.js","names":["E_MODEL_EXISTS","Error","E_UNINITIALIZED_GET","E_NO_VIRTUAL_SET","E_NO_VIRTUAL_DELETE","__exports","__esModule"],"sources":["errors.ts"],"sourcesContent":["export const E_MODEL_EXISTS = new Error(\r\n    'Model registration failed: model already exists.',\r\n);\r\nexport const E_UNINITIALIZED_GET = new Error(\r\n    'State service failed: invoked getter for uninitialized property.',\r\n);\r\nexport const E_NO_VIRTUAL_SET =\r\n    'Modifications to the virtual property are not allowed.';\r\nexport const E_NO_VIRTUAL_DELETE =\r\n    'Deletion of the virtual property is not allowed.';\r\n"],"mappings":"AAAA,sDAAO,MAAMA,EAAiB,IAAIC,MAC9B,oDAEG,MAAMC,EAAsB,IAAID,MACnC,oEAEG,MAAME,EACT,yDACG,MAAMC,EACT,mDAAmD,IAAAC,EAAA,CAAAC,WAAA,MAAAD,EAAAL,iBAAAK,EAAAH,sBAAAG,EAAAF,mBAAAE,EAAAD,sBAAA,OAAAC,CAAA","ignoreList":[],"sourceRoot":"misc"}},{"offset":{"line":16,"column":0},"map":{"version":3,"file":"Model.factory.js","names":["DEFAULT_BINDING_MODE","___misc_constants","DEFAULT_SIZE_LIMIT","ModelFactory","createModel","_ref","data","bindingMode","sizeLimit","model","JSONModel","setDefaultBindingMode","setSizeLimit","__exports","__esModule"],"sources":["Model.factory.ts"],"sourcesContent":["import JSONModel from 'sap/ui/model/json/JSONModel';\r\nimport type { ICreateModel } from './interfaces/ICreateModel';\r\nimport { DEFAULT_BINDING_MODE, DEFAULT_SIZE_LIMIT } from './misc/constants';\r\n\r\nexport class ModelFactory {\r\n    /**\r\n     * Factory method which creates a UI5 Model from given data payload.\r\n     * @param data The payload\r\n     * @param bindingMode The binding mode, defaults to `BindingMode.TwoWay`\r\n     * @param sizeLimit The model size limit, defaults to `400`\r\n     * @returns The created model\r\n     */\r\n    public static createModel<T extends {}>({\r\n        data,\r\n        bindingMode,\r\n        sizeLimit,\r\n    }: ICreateModel<T>): JSONModel {\r\n        const model = new JSONModel(data);\r\n        model.setDefaultBindingMode(bindingMode || DEFAULT_BINDING_MODE);\r\n        model.setSizeLimit(sizeLimit || DEFAULT_SIZE_LIMIT);\r\n        return model;\r\n    }\r\n}\r\n"],"mappings":"AAAA,+GAESA,EAAoBC,EAAA,8BAAEC,EAAkBD,EAAA,sBAE1C,MAAME,EAQT,kBAAcC,CAAWC,GAIM,IAJSC,KACpCA,EAAIC,YACJA,EAAWC,UACXA,GACcH,EACd,MAAMI,EAAQ,IAAIC,EAAUJ,GAC5BG,EAAME,sBAAsBJ,GAAeP,GAC3CS,EAAMG,aAAaJ,GAAaN,GAChC,OAAOO,CACX,EACH,IAAAI,EAAA,CAAAC,WAAA,MAAAD,EAAAV,eAAA,OAAAU,CAAA","ignoreList":[],"sourceRoot":"model-factory"}},{"offset":{"line":19,"column":0},"map":{"version":3,"file":"ICreateModel.js","names":[],"sources":[],"mappings":"AAAA,","ignoreList":[],"sourceRoot":"model-factory/interfaces"}},{"offset":{"line":22,"column":0},"map":{"version":3,"file":"constants.js","names":["DEFAULT_BINDING_MODE","BindingMode","TwoWay","DEFAULT_SIZE_LIMIT","__exports","__esModule"],"sources":["constants.ts"],"sourcesContent":["import BindingMode from 'sap/ui/model/BindingMode';\r\n\r\nexport const DEFAULT_BINDING_MODE = BindingMode.TwoWay;\r\nexport const DEFAULT_SIZE_LIMIT = 400;\r\n"],"mappings":"AAAA,iFAEO,MAAMA,EAAuBC,EAAYC,OACzC,MAAMC,EAAqB,IAAI,IAAAC,EAAA,CAAAC,WAAA,MAAAD,EAAAJ,uBAAAI,EAAAD,qBAAA,OAAAC,CAAA","ignoreList":[],"sourceRoot":"model-factory/misc"}},{"offset":{"line":25,"column":0},"map":{"version":3,"file":"DeepMutable.js","names":[],"sources":[],"mappings":"AAAA,","ignoreList":[],"sourceRoot":"types"}},{"offset":{"line":28,"column":0},"map":{"version":3,"file":"DeepPartial.js","names":[],"sources":[],"mappings":"AAAA,","ignoreList":[],"sourceRoot":"types"}},{"offset":{"line":31,"column":0},"map":{"version":3,"file":"DeepReadonly.js","names":[],"sources":[],"mappings":"AAAA,","ignoreList":[],"sourceRoot":"types"}}]}